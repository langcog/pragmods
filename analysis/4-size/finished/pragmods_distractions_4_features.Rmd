pragmods_distractions: More Plots
========================================================

```{r}
library(bootstrap)
library(ggplot2)
rm(list=ls())
#source("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/useful.R")
d1 <- read.csv("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/pragmods_distractions.results1.tsv", sep = "\t")
d2 <- read.csv("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/pragmods_distractions.results2.tsv", sep = "\t")
d3 <- read.csv("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/pragmods_distractions.results3.tsv", sep = "\t")
d <- rbind(d1, d2, d3)
```

Exclude participants that either failed manipulation check or were rejected.

```{r}
exclude <- d$assignmentstatus == "Rejected" | d$Answer.name_check_correct == "\"FALSE\""
sum(exclude)
mean(exclude)

d <- subset(d, exclude == FALSE)
d$Answer.scale_and_levels_condition <- factor(d$Answer.scale_and_levels_condition)
```

Define the necessary confidence interval functions. 

```{r}
l.mean <- function(...){mean(as.logical(...))}
l.theta <- function(x,xdata,na.rm=T) {l.mean(xdata[x],na.rm=na.rm)}
l.ci.low <- function(x,na.rm=T) {
  l.mean(x,na.rm=na.rm) - quantile(bootstrap(1:length(x),1000,l.theta,x,na.rm=na.rm)$thetastar,.025,na.rm=na.rm)}
l.ci.high <- function(x,na.rm=T) {
  quantile(bootstrap(1:length(x),1000,l.theta,x,na.rm=na.rm)$thetastar,.975,na.rm=na.rm) - l.mean(x,na.rm=na.rm)}
```

Aggregate choice_correct by scale_and_level_condition, and find the boundaries of the confidence intervals. 

```{r}
d$Answer.choice_correct <- d$Answer.choice_correct == "\"TRUE\""
choice_correct_aggregated <- aggregate(Answer.choice_correct ~ Answer.scale_and_levels_condition, d, l.mean)
choice_correct_aggregated$cil <- aggregate(Answer.choice_correct ~ Answer.scale_and_levels_condition, d, l.ci.low)$Answer.choice_correct

choice_correct_aggregated$cih <- aggregate(Answer.choice_correct ~ Answer.scale_and_levels_condition, d, l.ci.high)$Answer.choice_correct
```

Subset the data to see the effect of increasing number of irrelevant features on implicature. 

```{r}
choice_correct_aggregated <- subset(choice_correct_aggregated, choice_correct_aggregated$Answer.scale_and_levels_condition == 14 | choice_correct_aggregated$Answer.scale_and_levels_condition == 16 |choice_correct_aggregated$Answer.scale_and_levels_condition == 17 | choice_correct_aggregated$Answer.scale_and_levels_condition == 19 | choice_correct_aggregated$Answer.scale_and_levels_condition == 20)
```

Create a bar graph of the proportion of correct answers for each condition. 

```{r}
ggplot(data = choice_correct_aggregated, 
       aes(x = Answer.scale_and_levels_condition,
           y = Answer.choice_correct,
           fill = Answer.scale_and_levels_condition)) +
  geom_bar(stat = "identity", color = "black") +
  theme_bw() + geom_errorbar(aes(ymin = Answer.choice_correct - cil, ymax = Answer.choice_correct + cih), width = 0.2) + xlab("Condition") + ylab("Proportion of Correct Choices") + theme(axis.text=element_text(size=12), axis.title=element_text(size=16))
```


