pragmods_distractions: Experiment 3
========================================================

```{r}
library(bootstrap)
library(ggplot2)
rm(list=ls())
#source("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/useful.R")
d <- read.csv("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/pragmods_distractions.results3.tsv", sep = "\t")
```

Exclude participants that either failed manipulation check or were rejected.

```{r}
exclude <- d$assignmentstatus == "Rejected" | d$Answer.name_check_correct == "\"FALSE\""
sum(exclude)
mean(exclude)

d <- subset(d, exclude == FALSE)
d$Answer.scale_and_levels_condition <- factor(d$Answer.scale_and_levels_condition)
```

Define the necessary confidence interval functions. 

```{r}
l.theta <- function(x,xdata,na.rm=T) {l.mean(xdata[x],na.rm=na.rm)}
l.ci.low <- function(x,na.rm=T) {
  l.mean(x,na.rm=na.rm) - quantile(bootstrap(1:length(x),1000,l.theta,x,na.rm=na.rm)$thetastar,.025,na.rm=na.rm)}
l.ci.high <- function(x,na.rm=T) {
  quantile(bootstrap(1:length(x),1000,l.theta,x,na.rm=na.rm)$thetastar,.975,na.rm=na.rm) - l.mean(x,na.rm=na.rm)}
```

Aggregate choice_correct by scale_and_level_condition, and find the boundaries of the confidence intervals. 

```{r}
l.mean <- function(...){mean(as.logical(...))}
d$Answer.choice_correct <- d$Answer.choice_correct == "\"TRUE\""
choice_correct_aggregated <- aggregate(Answer.choice_correct ~ Answer.scale_and_levels_condition, d, l.mean)
choice_correct_aggregated$cil <- aggregate(Answer.choice_correct ~ Answer.scale_and_levels_condition, d, l.ci.low)$Answer.choice_correct

choice_correct_aggregated$cih <- aggregate(Answer.choice_correct ~ Answer.scale_and_levels_condition, d, l.ci.high)$Answer.choice_correct
```

Create a bar graph of the proportion of correct answers for each condition. 

```{r}
ggplot(data = choice_correct_aggregated, 
       aes(x = Answer.scale_and_levels_condition,
           y = Answer.choice_correct,
           fill = Answer.scale_and_levels_condition)) +
  geom_bar(stat = "identity", color = "black") +
  theme_bw() + geom_errorbar(aes(ymin = Answer.choice_correct - cil, ymax = Answer.choice_correct + cih), width = 0.2) + xlab("Condition") + ylab("Proportion of Correct Choices") + theme(axis.text=element_text(size=12), axis.title=element_text(size=16))
```

Create a data frame that includes all conditions to make analysis easier. 

```{r}
# rm(list=ls())
# d1 <- read.csv("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/pragmods_distractions.results1.tsv", sep = "\t")
# d2 <- read.csv("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/pragmods_distractions.results2.tsv", sep = "\t")
# d3 <- read.csv("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/pragmods_distractions.results3.tsv", sep = "\t")
# d_all <- rbind(d1, d2, d3)
```

Exclude participants that either failed manipulation check or were rejected for the new data frame.

```{r}
# exclude <- d_all$assignmentstatus == "Rejected" | d_all$Answer.name_check_correct == "\"FALSE\""
# sum(exclude)
# mean(exclude)
# 
# d_all <- subset(d_all, exclude == FALSE)
# d_all$Answer.scale_and_levels_condition <- factor(d_all$Answer.scale_and_levels_condition)
```

Subset the data to see the effect of increasing number of irrelevant features on implicature. 

```{r}
# d_3_objects <- subset(d_all, d_all$Answer.scale_and_levels_condition == 4 | d_all$Answer.scale_and_levels_condition == 11 | d_all$Answer.scale_and_levels_condition == 12 | d_all$Answer.scale_and_levels_condition == 19 | d_all$Answer.scale_and_levels_condition == 20)
```

Aggregate this new data frame by choice_correct. 

```{r}
# l.theta <- function(x,xdata,na.rm=T) {l.mean(xdata[x],na.rm=na.rm)}
# l.ci.low <- function(x,na.rm=T) {
#   l.mean(x,na.rm=na.rm) - quantile(bootstrap(1:length(x),1000,l.theta,x,na.rm=na.rm)$thetastar,.025,na.rm=na.rm)}
# l.ci.high <- function(x,na.rm=T) {
#   quantile(bootstrap(1:length(x),1000,l.theta,x,na.rm=na.rm)$thetastar,.975,na.rm=na.rm) - l.mean(x,na.rm=na.rm)}
# 
# l.mean <- function(...){mean(as.logical(...))}
# d_3_objects$Answer.choice_correct <- d_3_objects$Answer.choice_correct == "\"TRUE\""
# all_choice_correct_aggregated <- aggregate(Answer.choice_correct ~ Answer.scale_and_levels_condition, d_all, l.mean)
# 
# all_choice_correct_aggregated$cil2 <- aggregate(Answer.choice_correct ~ Answer.scale_and_levels_condition, d_all, l.ci.low)$Answer.choice_correct
# 
# all_choice_correct_aggregated$cih2 <- aggregate(Answer.choice_correct ~ Answer.scale_and_levels_condition, d_all, l.ci.high)$Answer.choice_correct
```

Plot the new data frame. 

```{r}
#ggplot(data = d_3_objects, 
#        aes(x = Answer.scale_and_levels_condition,
#            y = Answer.choice_correct,
#            fill = Answer.scale_and_levels_condition)) +
#   geom_bar(stat = "identity", color = "black") +
#   theme_bw() + geom_errorbar(aes(ymin = Answer.choice_correct - cil2, ymax = Answer.choice_correct + cih2), width = 0.2) + xlab("Condition") + ylab("Proportion of Correct Choices") + theme(axis.text=element_text(size=12), axis.title=element_text(size=16))
```
