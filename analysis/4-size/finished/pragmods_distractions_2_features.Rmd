pragmods_distractions: More Plots
========================================================

```{r}
library(bootstrap)
library(ggplot2)
rm(list=ls())
theme_set(theme_bw())
#source("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/useful.R")
d1 <- read.csv("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/pragmods_distractions.results1.tsv", sep = "\t")
d2 <- read.csv("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/pragmods_distractions.results2.tsv", sep = "\t")
d3 <- read.csv("/Users/lilgittel/Documents/CSLI/cognitive_limitations/R_code/pragmods_distractions.results3.tsv", sep = "\t")
d <- rbind(d1, d2, d3)
```

Exclude participants that either failed manipulation check or were rejected.

```{r}
exclude <- d$assignmentstatus == "Rejected" | d$Answer.name_check_correct == "\"FALSE\""
sum(exclude)
mean(exclude)

d <- subset(d, exclude == FALSE)
d$Answer.scale_and_levels_condition <- factor(d$Answer.scale_and_levels_condition)
```

Define the necessary confidence interval functions. 

```{r}
l.mean <- function(...){mean(as.logical(...))}
l.theta <- function(x,xdata,na.rm=T) {l.mean(xdata[x],na.rm=na.rm)}
l.ci.low <- function(x,na.rm=T) {
  l.mean(x,na.rm=na.rm) - quantile(bootstrap(1:length(x),1000,l.theta,x,na.rm=na.rm)$thetastar,.025,na.rm=na.rm)}
l.ci.high <- function(x,na.rm=T) {
  quantile(bootstrap(1:length(x),1000,l.theta,x,na.rm=na.rm)$thetastar,.975,na.rm=na.rm) - l.mean(x,na.rm=na.rm)}
```

Merge in condition information. 

```{r}
levels <- read.csv("~/Documents/CSLI/cognitive_limitations/R_code/scale_and_level.csv")
md <- merge(d,levels, by.x="Answer.scale_and_levels_condition", by.y="scale_and_level")
md$Type <- factor(md$level)
md$irrel.objs <- factor(md$irrel.objs)
md$irrel.feats <- factor(md$irrel.feats)
md$scale <- md$Answer.scale_and_levels_condition
md$irrel.targ.feats <- factor(md$irrel.targ.feats)
md$condition <- factor(md$condition)
```

Aggregate!

```{r}
library(plyr)
ms <- ddply(md, .(irrel.objs,irrel.feats,Type,scale,irrel.targ.feats, condition), summarise,
            n = length(Answer.choice_correct == "\"TRUE\""),
            corr = mean(Answer.choice_correct == "\"TRUE\""),
            corr.cih = l.ci.high(Answer.choice_correct == "\"TRUE\""),
            corr.cil = l.ci.low(Answer.choice_correct == "\"TRUE\""),
            L0=mean(L0), LS=mean(LS), LSL=mean(LSL), LSLS=mean(LSLS), LSLSL=mean(LSLSL), LSLSLS=mean(LSLSLS), LSLSLSLS=mean(LSLSLSLS))

```

Plot proportion of correct inferences vs. number of irrelevant objects. 

```{r}

#reclassify by num. of irrel. features for each target instead of "level"/type (look at just data and also data by model) (may or may not want #irrel feats from matrix in this plot)
# plot pairings of type-1 vs. type-2 paired by matrix, so you can compare across matrices (bar or line graph)
ms_subset <- subset(ms, ms$Type != 2)
corr_subset <- ms_subset$corr
scale_subset <- ms_subset$scale
qplot(irrel.objs, corr_subset, col=irrel.feats, 
      group=irrel.feats,
      ymin=corr_subset - corr.cil, ymax=corr_subset + corr.cih,
      position=position_dodge(width=.2),
      geom=c("pointrange", "line"),
      data=ms_subset) + 
  ylim(c(0,1)) + 
  #geom_text(aes(label=scale_subset), position=position_dodge(width=.75)) + 
  geom_hline(yintercept=.5,lty=2) + 
  ylab("Proportion of Correct Inferences") + 
  xlab("Number of Irrelevant Objects") + scale_fill_discrete(name="Uniform Features") + scale_colour_discrete(name="Number of Uniform Features") + theme_bw()
```

Models
-----

```{r}
qplot(L0, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats, pch=Type,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=1), method="lm", se=FALSE) +
  geom_text(aes(label=scale,x=L0 + .03)) + 
  ylim(c(0,1)) + 
  xlim(c(0,1)) + 
  xlab("Model Predictions (L0)") + 
  ylab("Human Proportion Correct")
```

Let's now look at LS.

```{r}
qplot(LS, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats,pch=Type,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=Type,lty=Type), col="black",method="lm", se=FALSE) +
  geom_text(aes(label=scale,x=LS + .03)) + 
  ylim(c(0,1)) + 
  xlim(c(0,1)) +
  xlab("Model Predictions (LS)") + 
  ylab("Human Proportion Correct")
```

Try that with two facets:

```{r}
qplot(LS, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=1), method="lm", se=FALSE) +
  geom_text(aes(label=scale,x=LS + .03)) + 
  ylim(c(0,1)) + 
  xlim(c(0,1)) + 
  xlab("Model Predictions (LS)") + 
  ylab("Human Proportion Correct") + 
  facet_grid(.~Type)
```

Now L0 (without facets): 
```{r}
qplot(L0, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats,pch=Type,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=Type,lty=Type), col="black",method="lm", se=FALSE) +
  geom_text(aes(label=scale,x=L0 + .03)) + 
  ylim(c(0,1)) + 
  xlim(c(0,1)) +
  xlab("Model Predictions (L0)") + 
  ylab("Human Proportion Correct")
```

Now LS (without facets): 

```{r}
qplot(LS, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats,
      pch=irrel.targ.feats,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=irrel.targ.feats,lty=irrel.targ.feats), col="black",method="lm", se=FALSE) +
  ylim(c(0,1)) + 
  xlim(c(0,1)) +
  xlab("Model Predictions (LS)") + 
  ylab("Human Proportion Correct") 
```

Now LSL (without facets): 

```{r}

qplot(LSL, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats,pch=Type,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=Type,lty=Type), col="black",method="lm", se=FALSE) +
  geom_text(aes(label=scale,x=LSL + .03)) + 
  ylim(c(0,1)) + 
  xlim(c(0,1)) +
  xlab("Model Predictions (LSL)") + 
  ylab("Human Proportion Correct")
```

Now LSLS: 

```{r}
qplot(LSLS, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats,pch=Type,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=Type,lty=Type), col="black",method="lm", se=FALSE) +
  geom_text(aes(label=scale,x=LSLS + .03)) + 
  ylim(c(0,1)) + 
  xlim(c(0,1)) +
  xlab("Model Predictions (LSLS)") + 
  ylab("Human Proportion Correct")
```

Now LSLSL (without facets): 

```{r}

#THIS PLOT IS WAY OFF (THE FIT ISN'T VERY GOOD). WHY?  
qplot(LSLSL, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats,pch=Type,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=Type,lty=Type), col="black",method="lm", se=FALSE) +
  geom_text(aes(label=scale,x=LSLSL + .03)) + 
  ylim(c(0,1)) + 
  xlim(c(0,1)) +
  xlab("Model Predictions (LSLSL)") + 
  ylab("Human Proportion Correct")
```

Now LSLSLS (without facets): 

```{r}
qplot(LSLSLS, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats,pch=Type,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=Type,lty=Type), col="black",method="lm", se=FALSE) +
  geom_text(aes(label=scale,x=LSLSLS + .03)) + 
  ylim(c(0,1)) + 
  xlim(c(0,1)) +
  xlab("Model Predictions (LSLSLS)") + 
  ylab("Human Proportion Correct")
```

Now LSLSLSLS (without facets): 

```{r}
qplot(LSLSLSLS, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats,pch=Type,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=Type,lty=Type), col="black",method="lm", se=FALSE) +
  geom_text(aes(label=scale,x=LSLSLSLS + .03)) + 
  ylim(c(0,1)) + 
  xlim(c(0,1)) +
  xlab("Model Predictions (LSLSLSLS)") + 
  ylab("Human Proportion Correct")
```

Models plots by irrelevant target feature
-----
L0: 

```{r}

#ASK MIKE OR ANDRES ABOUT THISâ€”WHY ISN'T IT SPLITTING UP BY irrel.targ.feats CORRECTLY?
qplot(LS, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats,pch=irrel.targ.feats,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=irrel.targ.feats,lty=irrel.targ.feats), col="black",method="lm", se=FALSE) +
  geom_text(aes(label=scale,x=LS + .03)) + 
  #geom_line(aes(linetype = irrel.targ.feats), size = 1.5) + 
  ylim(c(0,1)) + 
  xlim(c(0,1)) +
  xlab("Model Predictions (LS)") + 
  ylab("Human Proportion Correct")
```

LS: 

LSL: 

LSLS: 

LSLSL: 

LSLSLS: 

LSLSLSLS: 

Bar graphs: Type 1 vs. Type 2
-----

Presentation Plots
-----

Proportions of correct implicature across conditions: 


LS: 
```{r}
qplot(LS, corr, 
      ymin=corr - corr.cil, ymax=corr + corr.cih,
      geom="pointrange",
      col=irrel.feats,pch=Type,
      position=position_jitter(width=.01),
      data=ms) + 
  geom_smooth(aes(group=Type,lty=Type), col="black",method="lm", se=FALSE) +
  ylim(c(0,1)) + 
  xlim(c(0,1)) +
  xlab("Model Predictions (LS)") + 
  ylab("Human Proportion Correct") + scale_fill_discrete(name="Uniform Features") + scale_colour_discrete(name="Uniform Features") + scale_shape_discrete(name="Type") 
```

Model correlations 
-----

```{r}
cor.test(ms$L0, ms$corr)
cor.test(ms$LS, ms$corr)
cor.test(ms$LSL, ms$corr)
cor.test(ms$LSLS, ms$corr)
cor.test(ms$LSLSL, ms$corr)
cor.test(ms$LSLSLS, ms$corr)
cor.test(ms$LSLSLSLS, ms$corr)
```

Bar chart

```{r}
bar_subset <- subset(ms, ms$scale == 8 | ms$scale == 9 | ms$scale == 11 | ms$scale == 12 | ms$scale == 16 | ms$scale == 17 | ms$scale == 19 | ms$scale == 20)

ggplot(data=bar_subset, aes(x=scale, y=corr, fill=bar_subset$condition)) + 
  geom_bar(stat="identity", color="black") + theme_bw() + geom_errorbar(aes(ymin=corr - corr.cil, ymax =corr + corr.cih), width = 0.2) + xlab("Condition") + ylab("Proportion of Correct Choices") + theme(axis.text = element_text(size = 12), axis.title = element_text(size = 16)) + scale_fill_discrete(name="Matrix Number") + scale_colour_discrete(name="Matrix Number")
```

```{r}
bar_subset <- subset(ms, ms$scale == 8 | ms$scale == 9 | ms$scale == 16 | ms$scale == 17)

ggplot(data=bar_subset, aes(x=scale, y=corr, fill=bar_subset$condition)) + 
  geom_bar(stat="identity", color="black") + theme_bw() + geom_errorbar(aes(ymin=corr - corr.cil, ymax =corr + corr.cih), width = 0.2) + xlab("Condition") + ylab("Proportion of Correct Choices") + theme(axis.text = element_text(size = 12), axis.title = element_text(size = 16)) + scale_fill_discrete(name="Matrix Number") + scale_colour_discrete(name="Matrix Number")

bar_subset <- subset(ms, ms$scale == 11 | ms$scale == 12 | ms$scale == 19 | ms$scale == 20)

ggplot(data=bar_subset, aes(x=scale, y=corr, fill=bar_subset$condition)) + 
  geom_bar(stat="identity", color="black") + theme_bw() + geom_errorbar(aes(ymin=corr - corr.cil, ymax =corr + corr.cih), width = 0.2) + xlab("Condition") + ylab("Proportion of Correct Choices") + theme(axis.text = element_text(size = 12), axis.title = element_text(size = 16)) + scale_fill_discrete(name="Matrix Number") + scale_colour_discrete(name="Matrix Number")
```
